<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Brian Osborne"><meta name=description content="I&rsquo;m working in creating a Drupal 8 installation profile and learning how they can override default configuration that its modules provide at install time.
All Drupal 8 modules can provide a set of configuration that should be installed to the site when the module is installed. This configuration is placed in the module&rsquo;s config/install or config/optional directory. The only difference is that the configuration objects placed in the config/optional directory will only be installed if all of their dependencies are met."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Overriding module configuration in a Drupal 8 installation profile (with some &#34;gotchas&#34;)"><meta name=twitter:description content="I&rsquo;m working in creating a Drupal 8 installation profile and learning how they can override default configuration that its modules provide at install time.
All Drupal 8 modules can provide a set of configuration that should be installed to the site when the module is installed. This configuration is placed in the module&rsquo;s config/install or config/optional directory. The only difference is that the configuration objects placed in the config/optional directory will only be installed if all of their dependencies are met."><meta property="og:title" content="Overriding module configuration in a Drupal 8 installation profile (with some &#34;gotchas&#34;)"><meta property="og:description" content="I&rsquo;m working in creating a Drupal 8 installation profile and learning how they can override default configuration that its modules provide at install time.
All Drupal 8 modules can provide a set of configuration that should be installed to the site when the module is installed. This configuration is placed in the module&rsquo;s config/install or config/optional directory. The only difference is that the configuration objects placed in the config/optional directory will only be installed if all of their dependencies are met."><meta property="og:type" content="article"><meta property="og:url" content="http://www.example.com/blog/overriding-module-configuration-in-a-drupal-8-installation-profile-with-some-gotchas/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-03-23T00:00:00-04:00"><meta property="article:modified_time" content="2018-03-23T00:00:00-04:00"><title>Overriding module configuration in a Drupal 8 installation profile (with some "gotchas") · Brian Osborne</title><link rel=canonical href=http://www.example.com/blog/overriding-module-configuration-in-a-drupal-8-installation-profile-with-some-gotchas/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.531b74bda2bd1e0562323a98f617314ce9c7cc8c8cffbc609f5f690abf6ac68c.css integrity="sha256-Uxt0vaK9HgViMjqY9hcxTOnHzIyM/7xgn19pCr9qxow=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.002ee2378e14c7a68f1f0a53d9694ed252090987c4e768023fac694a4fc5f793.css integrity="sha256-AC7iN44Ux6aPHwpT2WlO0lIJCYfE52gCP6xpSk/F95M=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><meta name=generator content="Hugo 0.82.1"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Brian Osborne</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://www.example.com/blog/overriding-module-configuration-in-a-drupal-8-installation-profile-with-some-gotchas/>Overriding module configuration in a Drupal 8 installation profile (with some "gotchas")</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2018-03-23T00:00:00-04:00>March 23, 2018</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/drupal-planet/>Drupal Planet</a></span></div></div></header><div><p>I&rsquo;m working in creating a Drupal 8 installation profile and learning how they can override default configuration that its modules provide at install time.</p><p>All Drupal 8 modules can provide a set of configuration that should be installed to the site when the module is installed. This configuration is placed in the module&rsquo;s <code>config/install</code> or <code>config/optional</code> directory. The only difference is that the configuration objects placed in the <code>config/optional</code> directory will only be installed if all of their dependencies are met. For example, the core &ldquo;media&rdquo; module has a config file <code>config/optional/views.view.media.yml</code> which will install the standard media listings view, but only if the views module is available on your site at the time of install.</p><p>The power of installation profiles is that they can provide <em>overrides</em> for any configuration objects that a module would normally provide during its installation. This is accomplished simply by placing the config object file in the installation profile&rsquo;s <code>config/install</code> or <code>config/optional</code> directory. This works because when Drupal&rsquo;s <code>ConfigInstaller</code> is installing any configuration object, it checks to see if that config object exists in your installation profile, and uses that version of it if it exists.</p><p>However, overriding default configuration that a module would normally provide is a double edged sword and brings up some interesting challenges.</p><p>If you dramatically alter a configuration object that a module provides, what happens when that module releases a new version that includes an update hook to modify that config? The module maintainers may write the update hook assuming that the config object that&rsquo;s installed on your site is identical to the one that it provided out-of-the-box during install time. I think this falls on the module maintainer to write update hooks that first check to make sure that the config object is mostly what it expects it to be before modifying it. If not, fatal errors could be thrown.</p><p>Another challenge that I ran into recently is more complicated. My installation profile was overriding an <a href=https://www.drupal.org/project/entity_browser>entity browser</a> config object provided by the <a href=https://drupal.org/project/lightning_media>Lightning Media</a> module. Entity browsers use views to display lists of entities on your site that an editor can choose from. My override changed this config object to point to a custom view that my installation profile provided (placed in its <code>config/install</code> directory), but it didn&rsquo;t work. When installing a site with the profile, I was met with an UnmetDependenciesException which claimed that the entity browser override I provided depended on a view that didn&rsquo;t exist. Well, it <em>did</em> exist, it&rsquo;s right there in the install folder for the profile! After some debugging, this is happening because the Drupal doesn&rsquo;t install config from the installation profile until all of the modules your install profile depends are installed first. So to summarize, it&rsquo;s not possible for a module&rsquo;s default config objects to depend on config that is provided by an install profile.</p></div><footer><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//bkosborne.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></section></div><footer class=footer><section class=container>©
2010 -
2022
Brian Osborne
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.39a51230dce2ac866c049b52573e38bf60666af4bc63c1bdf203b9b2d95b1cd6.js integrity="sha256-OaUSMNzirIZsBJtSVz44v2BmavS8Y8G98gO5stlbHNY="></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "bd8a23ecd0e34c58a89099ab25d009a"}'></script></body></html>